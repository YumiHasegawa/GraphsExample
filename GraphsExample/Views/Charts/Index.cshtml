@using Omu.Awem.Helpers
@using Omu.AwesomeMvc
@using GraphsExample.Helpers
@model GraphsExample.ViewModels.ChartsViewModel

@{
    ViewData["Title"] = "Highcharts";
}

@using (Html.Awe().BeginContext())
{
    @Html.DisplayForModel()
    var grid = "ChartsJS";
    var gridId = Html.Awe().GetContextPrefix() + grid;
    object gg = null;

    <div>
        @(Html.Awe().Grid(grid)
            .Url(Url.Action("GridGetItems", "Charts"))
            .RowClassClientFormat("infoBackground")
            .Mod(a => a.Loading(true, true, "no items"))
            .Columns(
                new Column { Header = "Graph column", Width = 200, ClientFormatFunc = "getImage" },
                new Column { Header = "Any column" }
            )
        .ShowGroupBar(false)
        .Groupable(false)
        .Sortable(false)
        .Reorderable(false)
        .Resizable(true)
        .Paging(false)
        .Persistence(Persistence.None))
    </div>
    <div>
        <canvas id="myChart"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript">
        /*function getGraph(o) {
            $.ajax({
                type: "GET",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                data: {
                    "valuesStr": JSON.stringify(o.values),
                    "chartName": "Values"
                },
                async: false,
                url: '/Charts/GetChartImgByValues'
            }).then(function (response) {
                console.log(response);
                var arr = response.split('<script');
                $('<script' + arr[1]).appendTo(document.body);
                return arr[0];
            });
        }*/

        function getImage(o) {

        }

        const labels = [
            'January',
            'February',
            'March',
            'April',
            'May',
            'June',
        ];
        const data = {
            labels: labels,
            datasets: [{
                label: 'My First dataset',
                backgroundColor: 'rgb(255, 99, 132)',
                borderColor: 'rgb(255, 99, 132)',
                data: [0, 10, 5, 2, 20, 30, 45],
            }]
        };

        const config = {
            type: 'line',
            data,
            options: {}
        };

        var myChart = new Chart(
            document.getElementById('myChart'),
            config
        );

    </script>
}